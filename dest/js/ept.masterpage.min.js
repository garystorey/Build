!function(e,t,s,n){"use strict";var a={};a.settings={debug:!1,cache:!0,quicklinkUrl:"/mylinks/_layouts/15/MyQuickLinks.aspx?isDlg=1",closebutton:'<div class="macys-button {{closebuttonclass}}"><span class="macys-button-text"></span></div>',defaultPicture:"/_layouts/15/images/o14_person_placeholder_32.png",favUrl:"//mysites.mymacys.net/addfavorites.aspx?isDlg=1&source99={{loc}}&title99={{title}}",favWindow:"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes"},a.classes={close:"macys-button-close"},a.init=function(){n.isTrue(n.url.qs.nocache)&&(a.settings.cache=!1),a.events(),a.picture.load()},a.addCloseButton=function(){return a.settings.closebutton.replace("{{closebuttonclass}}",a.classes.close)},a.events=function(){e("#s4-bodyContainer").on("click.mp","."+a.classes.close,function(){a.menu.close()}),e(".macys-header-user").on("click.mp",function(e){var t=location.href.indexOf("/_layout")>-1?"zz6_Menu":"zz7_Menu";return CoreInvoke("MMU_Open",byid("zz2_ID_PersonalActionMenu"),MMU_GetMenuFromClientId(t),e,!0,null,0),!1}),e("#macys-onedrive").on("click",function(){t.open("http://mysites.mymacys.net/personal/"+n.user.UserName+"/Documents/Forms/All.aspx")}),e("#macys-o365").on("click",function(){t.open("https://portal.office.com/Home")}),e("#macys-yammer").on("click",function(){t.open("https://www.yammer.com/office365")}),e("#macys-osites").on("click",function(){t.open(" http://mysites.mymacys.net/Person.aspx")}),e(s).on("click","#macys-addfav",function(e){e.preventDefault();var n=location.href.replace("#s4-bodyContainer","");return t.open("//mysites.mymacys.net/addfavorites.aspx?isDlg=1&source99="+n+"&title99="+s.title,"AddFav","menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes,width=350,height=350"),!1})},a.isEditMode=function(){return!("undefined"==typeof macysEditMode||""===e("#MSOLayout_InDesignMode").val())},a.picture={},a.picture.load=function(){var t=n.retrieve("pictureUrl");t||(t=n.getUserPicUrl(),n.store("pictureUrl",t,"session"));var s=e("#welcomeMenuBox").find('a[title="Open Menu"]'),a=s.text().replace("Use SHIFT+ENTER to open the menu (new window).","");s.html('<img src="'+t+'" height="39" width="39"/>').attr("title",a)},t.mp=a,n.onload("mp.init")}(jQuery,window,document,ept),function(e,t,s,n,a){"use strict";a.footer={},a.settings.footer={link:'<span class="macys-footer-item"><a href="{{url}}" target="{{target}}"">{{title}}</a></span>',seperator:'<span class="macys-footer-separator"></span>'},a.footer.init=function(){n.log("mp.footer.init");var t=e("#MacysFooter");if(t.length){var s=n.retrieve("mmfooter");if(s)return void t.html(s);s="",e.when(n.getSPList("/","MacysFooter","$orderby=Sortorder asc")).done(function(e){for(var o,i=e.d.results,c=0,r=i.length;c<r;c++)o=i[c],n.isTrue(o.Active)&&(s+=a.settings.footer.link,s+=c<r-1?a.settings.footer.seperator:"",s=s.replaceAll("{{url}}",o.URL.Url).replaceAll("{{title}}",o.URL.Description),s=n.isTrue(o.OpenInNewWindow)?s.replaceAll("{{target}}","_blank"):s.replaceAll("{{target}}",""),n.store("mmfooter",s,"session"),t.html(s))})}},n.onLoad("mp.footer.init")}(jQuery,window,document,ept,mp),function(e,t,s,n,a){"use strict";a.menu={},a.classes.menu={selectednav:"is-selected",all:"macys-menu",primary:"macys-header-nav-area"},a.menu.tiles={},a.menu.selected=null,a.menu.allmenus=null,a.menu.primary=null,a.menu.open=function(t){n.log("mp.menu.open");var s=e("#"+t.data("show")),o=t.data("load"),i=n.isTrue(t.data("cache")),c=n.isTrue(t.attr("data-loaded"));return location.href="#s4-bodyContainer",a.menu.current(t),s.show(),!n.isTrue(c)&&o&&a.menu.load(s,o,i),this},a.menu.close=function(){n.log("mp.menu.close"),a.menu.selected=null,a.menu.allmenus.hide(),e("."+a.classes.menu.selectednav).removeClass(a.classes.menu.selectednav)},a.menu.toggle=function(e){n.log("mp.menu.toggle"),a.menu.compare(e,a.menu.selected)?(a.menu.close(),a.menu.selected=null):(a.menu.close(),a.menu.open(e))},a.menu.current=function(t){return n.log("mp.menu.current"),t?(a.menu.selected=t,e("."+a.classes.menu.selectednav).removeClass(a.classes.menu.selectednav),t.addClass(a.classes.menu.selectednav),t):a.menu.selected},a.menu.compare=function(e,t){return n.log("mp.menu.compare"),!(!t||!e)&&e[0]===t[0]},a.menu.keycheck=function(e){n.log("mp.menu.keycheck"),n.compareKey(e,n.keys.ESCAPE)&&a.menu.close()},a.menu.load=function(e,t,s){n.log("mp.menu.load");var o=n.isTrue(n.url.qs.isdlg),i=n.isTrue(a.settings.cache),c=e.attr("id"),r="//"+n.url.hostname+t+" #macys-navigation-cnt",l=!o&&!s&&i&&n.retrieve(c);return n.isTrue(l)?void e.html(l).trigger("menuPageLoaded",{id:c,page:t,area:e[0]}):void e.load(r,function(o,i,r){o=r,"error"===i.toLowerCase()?e.html("<h1>Failed to load content</h1>"+a.addCloseButton()):(e.append(a.addCloseButton()).trigger("menuPageLoaded",{id:c,page:t,area:e[0]}),s&&n.store(c,e.html(),"session"))})},a.menu.events=function(){n.log("mp.menu.events"),e("body").on("keyup.mp",function(e){a.menu.keycheck(e)}),a.menu.primary.on("click.mp",function(){a.menu.toggle(e(this))}),a.menu.bu.on("click.mp",function(){a.menu.toggle(e(this)),a.mdd.open()}),e(s).on("menuPageLoaded",function(e,t){a.tiles.check(e,t)})},a.menu.init=function(){n.log("mp.menu.init"),a.menu.allmenus=e("."+a.classes.menu.all),a.menu.primary=e("."+a.classes.menu.primary).not("#nav-businessunits"),a.menu.bu=e("#nav-businessunits"),a.menu.events()},n.onLoad("mp.menu.init")}(jQuery,window,document,ept,mp),function(e,t,s,n,a){"use strict";a.mdd={},a.mdd.nav=null,a.settings.mdd={menu:'<li><div data-current="false" class="macys-accordion-header"><span></span>{{category}}</div><div class="macys-accordion-content"><ul class="macys-subnav-links">',menuend:"</ul></div></li>",menuitem:'<li><div data-cache="true" data-loaded="false" data-load="{{url}}" data-show="{{area}}" id="link-{{area}}" class="{{classes}}">{{title}}</div></li>',content:'<div id="{{area}}" class="macys-subnav-area"><h1><img src="/_layouts/images/loading.gif" alt="loading" width="50" height="50" />Working On It...</h1></div>',accordionOptions:{headerClass:"macys-accordion-header",contentClass:"macys-accordion-content",expandClass:"macys-accordion-expanded",showArea:".macys-accordion-active",activeClass:"macys-accordion-active",oneAreaAlwaysVisible:!0,showMultipleAreas:!1}},a.classes.mdd={navigate:"macys-bu",accordion:"macys-nav-accordion",subnavlinks:"macys-subnav-title",subnavareas:"macys-subnav-area",accordionheaders:"macys-accordion-header",subnavContent:"macys-subnav-content",subnavlinkholder:"macys-subnav-links"},a.mdd.init=function(){n.log("mp.mdd.init"),a.mdd.nav=e("#macys-navigation")},a.mdd.open=function(){n.log("mp.mdd.open");var e=a.mdd.nav;n.isTrue(e.data("loaded"))?a.mdd.setup():a.mdd.load()},a.mdd.show=function(t){n.log("mp.mdd.show");var s=e("#"+t.data("show")),o=t.data("load"),i=n.isTrue(t.data("cache")),c=n.isTrue(t.attr("data-loaded"));a.mdd.close(),t.addClass(a.settings.mdd.accordionOptions.activeClass),s.show(),!n.isTrue(c)&&o&&a.menu.load(s,o,i)},a.mdd.load=function(){n.log("mp.mdd.load");var e,t="$orderby=Category%20asc,OrderBy%20asc";e=n.retrieve("accordion-menu"),e?(a.mdd.accordion(e,n.retrieve("subnavContent")),a.mdd.setup()):(e=n.getSPList("/","EnterpriseFOBNavigation",t),e.done(function(e){a.mdd.build(e.d.results)})),a.mdd.nav.data("loaded","true")},a.mdd.setup=function(){n.log("mp.mdd.setup"),e("."+a.classes.mdd.accordion).accordion("show:."+a.settings.mdd.accordionOptions.activeClass)},a.mdd.accordion=function(t,s){n.log("mp.mdd.accordion"),e("."+a.classes.mdd.accordion).find(">ul").append(t),e("."+a.classes.mdd.subnavContent).append(s),e("."+a.classes.mdd.accordion).accordion(a.settings.mdd.accordionOptions),e("."+a.classes.mdd.subnavlinkholder).on("click.mp","."+a.classes.mdd.subnavlinks,function(){a.mdd.show(e(this))})},a.mdd.toggle=function(t){n.log("mp.mdd.toggle");var s=e(t.target);a.mdd.close(),s.addClass(a.settings.mdd.accordionOptions.activeClass),a.mdd.show(s)},a.mdd.current=function(){a.menu.allmenus.find("."+a.classes.selectedarrows).removeClass(a.classes.selectedarrows),a.menu.selected.addClass(a.classes.selectednav).find("."+a.classes.arrows).addClass(a.classes.selectedarrows)},a.mdd.close=function(){n.log("mp.mdd.close"),e("."+a.classes.mdd.subnavareas).hide(),e("."+a.classes.mdd.subnavlinks).removeClass(a.settings.mdd.accordionOptions.activeClass)},a.mdd.build=function(e){n.log("mp.mdd.build");for(var t=a.settings.mdd.menu,s=a.settings.mdd.menuitem,o=a.settings.mdd.menuend,i=a.settings.mdd.content,c="",r=0,l=e.length,d="",u="",m="",p=!0,h=n.getNavFOB().toString().toLowerCase();r<l;r++){var g=e[r],y=!1,f=g.Category.toString().toLowerCase();n.strictEqual(c,g.Category)||(d+=o+a.mdd.replace(t,g),c=g.Category),h.has(","+f+",")?(y=!0,p&&h.startsWith(","+f+",")?(u="macys-subnav-title macys-subnav-default "+a.settings.mdd.accordionOptions.activeClass,p=!1):u="macys-subnav-title"):(u="macys-subnav-title",y=!1),g.Category=g.Category.replace(" ","__"),m+=a.mdd.replace(i,g),d+=a.mdd.replace(s,g),d=d.replaceAll("{{classes}}",u).replaceAll("{{ismynav}}",y),g.Category=g.Category.replace("__"," ")}d+=o,n.store("accordion-menu",d,"session"),n.store("subnavContent",m,"session"),a.mdd.accordion(d,m),a.mdd.setup()},a.mdd.replace=function(e,t){n.log("mp.mdd.replace");var s=t.Title.toString().trim(),a=t.Category.toString().trim(),o=t.URL.toString().trim(),i=a+"_"+s;return i=i.replaceAll(" ","").replace(/[^\w\s]/gi,""),e.replaceAll("{{category}}",a).replaceAll("{{title}}",s).replaceAll("{{area}}",i).replaceAll("{{url}}",o)},n.onLoad("mp.mdd.init")}(jQuery,window,document,ept,mp),function(e,t,s,n,a){"use strict";a.plugins={},a.plugins.init=function(){n.log("mp.plugins.init"),a.isEditMode()||a.plugins.tabs()},a.plugins.tabs=function(){n.log("mp.plugins.tabs");var t=e(".macys-tab-webpart");t.length&&e.getScript("/_layouts/15/MyMacys/scripts/ept.tabs.min.js",function(){t.macysTabs()})},n.onLoad("mp.plugins.init")}(jQuery,window,document,ept,mp),function(e,t,s,n,a){"use strict";a.classes.search={searchbox:"macys-search",btn:"macys-search-btn",scope:"macys-search-scopes",input:"macys-search-input"},a.search={url:{pre:"/sites/searchCenter/pages/",post:"?k="},init:function(){n.log("mp.search.init"),a.search.addEvents();var t=n.url.qs.k;t&&e("."+a.classes.search.input).val(unescape(t)),a.search.checkUrl()},checkUrl:function(){var e,t,s=n.url.href+"";s=s.toLowerCase(),s.indexOf("sites/searchcenter")>-1&&(e=s.split("?"),e=e[0].split("#"),t=e[0].lastIndexOf("/"),s=e[0].slice(t+1,e[0].length),a.search.setSelection("page",s))},setSelection:function(t,s){e("."+a.classes.search.scope).find("option").each(function(){var t=e(this),n=t.attr("data-page")+"";n.toUpperCase()===s.toUpperCase()&&t.prop("selected",!0)})},addEvents:function(){n.log("mp.search.addEvents"),e("."+a.classes.search.scope).on("change.mp",function(){var t=e(this),s=t.find("option:selected").val();"All"===s&&(s="all of the portal"),e("#searchbox").attr("placeholder","Search "+s).focus()}),e("."+a.classes.search.input).on("keypress.mp",function(e){a.search.keycheck(e)}),e("."+a.classes.search.btn).on("click.mp",function(e){a.search.find(e)})},keycheck:function(e){n.log("mp.search.keycheck"),n.compareKey(e,n.keys.ENTER)&&a.search.find(e)},find:function(s){n.log("mp.search.find");var o=e("."+a.classes.search.scope).find(":selected"),i=o.data("page"),c=e("."+a.classes.search.input),r=c.val();return s.preventDefault(),""===r.trim()?void c.val(""):(i=a.search.url.pre+i+a.search.url.post+encodeURIComponent(r),n.log(" - search URL: "+i),void(t.location=i))}},n.onLoad("mp.search.init")}(jQuery,window,document,ept,mp),function(e){"use strict";var t={},s=[],n=function(e,t){return e.getAttribute("data-"+t)},a=function(){return{tiles:[],height:1,width:2,display:"hide",parent:"",set:""}},o=function(e,t){return t=t.trim(),"1x1"===e&&"2x1"===e&&"1x2"===e||!t?"macys-tile-no-desc":"macys-tile-desc"},i=function(){var t=document.querySelectorAll(".macys-tile-container");e.forEach(t,function(e){e.classList.contains("macys-tile-show")||e.classList.contains("macys-tile-hide")||(e.classList.add("macys-tile-hide"),e.parentNode.setAttribute("style",""))})},c=function(){var e=document.querySelector(".macys-tile-overlay"),t=e.getAttribute("data-show")+"".toLowerCase();e.style.display="none",e.setAttribute("data-opener",""),e.setAttribute("data-showing",""),t=document.getElementById(t),t.setAttribute("style",""),t.style.display="none",t.querySelector(".macys-tile-container").classList.add("macys-tile-hide")},r=function(){var t=document.querySelector(".macys-tile-overlay");return t||(t=e.createElement({tag:"div",text:"",id:"",classes:["macys-tile-overlay"]})),document.body.appendChild(t),t.addEventListener("click",c),t},l=function(){return{title:"",id:"",set:"",badge:"",type:"standard",url:"#",icon:"None",color:"Red",size:"1x1",row:"A",column:"1",target:"",description:"",tiledescription:"",hasDescription:"macys-tile-no-desc",isGroupTile:!1}},d=function(t){e.log("fn:parseUrl");var s={},n=t.split("?");if(t=n[1]){var a=t.split("&");if(a.length)for(var o,i=0;i<a.length;i++)o=a[i].toString().toLowerCase().split("="),s[decodeURI(o[0])]=o.length>1?decodeURI(o[1]):""}return s.set?s.set=s.set.trim():s.set="1",s.startLocation?s.startLocation=s.startLocation.trim():s.startLocation="A1",s.height?s.height=s.height.trim():s.height="1",s.width?s.width=s.width.trim():s.width="2",s},u=function(t,s,a){var i=t.querySelector("a"),c=n(t,"size")+"",r=i.innerHTML,u=n(t,"type")+"",p=l(),h=i.getAttribute("title");if(h=h?h+"":"",e.log("i:"+s),u=u.toLowerCase(),p.title=r.trim(),p.id=a.set+"-"+(s+1),p.set=a.set+"",p.badge=n(t,"badge")+"",p.icon=n(t,"icon")+"",p.color=n(t,"color")+"",p.size=c,p.row=n(t,"row")+"",p.column=n(t,"column")+"",p.description=h,p.tiledescription=i.getAttribute("title"),p.hasDescription=o(c,h),p.target=i.getAttribute("target")+"",p.type=u,"standard"===u&&(p.isGroupTile=!1,p.url=i.getAttribute("href")),"group"===u){var g=d(i.getAttribute("href")),y="javascript:tiles.open('{{set}}','"+p.set+"');";p.isGroupTile=!0,p.url=y.replace("{{set}}",e.removeSpecialChars(e.removeSpaces(g.set)))}return"weather"!==u&&"stocks"!==u||(p.isGroupTile=!1,p.url="#",v("http://mymacys.net/Pages/stockandweatherdata.aspx?type="+u,m)),p},m=function(t){e.log(t)},p=function(o,i){var c=n(o,"tileset"),r=o.querySelectorAll("li"),l=a();e.log("i:"+i),l.parent="#tileset-holder-"+c,l.display=n(o,"display")+"",l.set=c,l.height=n(o,"tile-height")+"",l.width=n(o,"tile-width")+"",e.forEach(r,function(e,t){s.push(u(e,t,l))}),l.tiles=s,t.createSet(l),s.length=0},h=function(e){var t=[e.scrollHeight,e.clientHeight,e.offsetHeight].sort();return t[0]+10},g=function(e){var t=[e.scrollWidth,e.clientWidth,e.offsetWidth].sort();return t[0]+10},y=function(t){e.log("fn:centerTileSet");var s=Math.max(0,(window.innerHeight-h(t))/2),n=Math.max(0,(window.innerWidth-g(t))/2);s>250&&(s=250),t.style.top=s+"px",t.style.left=n+"px"},f=function(e,t){var s=new XMLHttpRequest;return"withCredentials"in s?s.open(t,e,!0):"undefined"!=typeof XDomainRequest?(s=new XDomainRequest,s.open(t,e)):s=null,s},v=function(t,s,n){n=n||"GET";var a=f(t,n);return a?(a.onload=function(){s(a.reponseText)},a.onerror=function(){e.log("Woops, there was an error making the request.")},void a.send()):void e.log("CORS not supported")};t.check=function(t,s){var a,o,i;e.log("mp.menu.tiles.check"),e.log("event: "+t),e.isEditMode()||(a=s?document.getElementById(s.id):document.body,o=a.querySelectorAll("ul[data-tileset]"),e.forEach(o,function(t,s){i=e.createElement({tag:"div",id:"tileset-holder-"+n(t,"tileset"),text:""}),o[s].parentNode.appendChild(i),p(t,s),t.parentNode.removeChild(t)}))},t.createSet=function(t){e.log("fn:mp.menu.tiles.createSet");var s,n=new TileSet;return n.parent=t.parent,n.height=t.height,n.width=t.width,n.display=t.display,n.startAt="A1",n.init(),n.add(t.tiles),s=n.getId(),n=null,s},t.open=function(e,t){var s=document.getElementById("tileset-holder-"+e),n=s.querySelector(".macys-tile-container"),a=r();i(),a.setAttribute("data-opener","tileset-holder-"+t),a.setAttribute("data-show","tileset-holder-"+e),a.style.display="block",a.style.transform="scale(1)",s.style.backgroundColor="#fff",s.style.position="absolute",s.style.display="block",s.style.zIndex=1000001,s.style.padding="10px",y(s),n.classList.remove("macys-tile-hide")},window.tiles=t,e.onLoad("tiles.check")}(ept);